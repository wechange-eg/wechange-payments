{% load i18n cosinnus_tags %}

{% if payment_popup_times_closed_before > 0 or request.GET.popup_type == 'repeat' %}
	{% comment %} Default, long running, monthly reappearing version {% endcomment %}
	
	{% trans "popup header" context "(POP1-repeat)" as title %}
	{% captureas body %}
		<p>
			{% trans "dear user," context "(POP2-repeat)" %}
		</p>
		<p>
			{% trans "popup body text " context "(POP3-repeat)" as pop_text %}
			{{ pop_text|linebreaksbr }}
		</p>
		<hr class="invisible" />
	{% endcaptureas %}
{% elif payment_popup_user_registered_after_payments or request.GET.popup_type == 'newuser' %}
	{% comment %} Newly registered user, 5-day or so delayed version {% endcomment %}
	
	{% trans "popup header" context "(POP1-newuser)" as title %}
	{% captureas body %}
		<p>
			{% trans "Dear WECHANGE-Community," context "(POP2-newuser)" %}
		</p>
		<p>
			{% trans "popup body text" context "(POP3-newuser)" as pop_text %}
			{{ pop_text|linebreaksbr }}
		</p>
		<hr class="invisible" />
	{% endcaptureas %}
{% else %}
	{% comment %} Old user (registered before payments were introduced) one-time shown version {% endcomment %}
	
	{% trans "popup header" context "(POP1-release)" as title %}
	{% captureas body %}
		<p>
			{% trans "dear user," context "(POP2-release)" %}
		</p>
		<p>
			{% trans "popup body text" context "(POP3-release)" as pop_text %}
			{{ pop_text|linebreaksbr }}
		</p>
		<hr class="invisible" />
	{% endcaptureas %}
{% endif %}

	{% comment %}  
	Inspirational quote is out for now	
	
	<p>
		<b>{% trans "'inspirational quote'" context "(POP4a)" %}</b>
		<br/>
		{% trans "quote credit" context "(POP4b)" %}</b>
		
	</p>
	{% endcomment %}

{% captureas buttons %}
	<a href="{% include 'wechange_payments/partials/url_learn_more.html' %}" class="rounded-button button-color-secondary">
        <span class="rounded-button-inner">
            {% trans "Learn more" context "(POP5)" %}
        </span>
    </a>
    <a href="{% url 'wechange-payments:overview' %}" class="rounded-button button-color-primary-inverted">
        <span class="rounded-button-inner">
            {% trans "Choose amount" context "(POP6)" %}
        </span>
    </a>
{% endcaptureas %}

{% include "cosinnus/v2/elements/modal_box.html" with id="payments_popup" title=title body=body buttons=buttons %}

<script type="text/javascript">
	$('#payments_popup button.close').on('click', function(){
		$.ajax({url: '{% url "wechange-payments:api-snooze-popup" %}', type: 'POST'});
	});
    $('#payments_popup').modal('show');
</script>
